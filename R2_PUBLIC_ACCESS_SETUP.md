# Настройка публичного доступа к R2 для мотивационных карточек

## Проблема
Мотивационные карточки не отображаются, потому что R2 bucket настроен как приватный и возвращает `401 Unauthorized` на прямые URL.

## Безопасное решение

### 1. Настроить bucket policy для публичного доступа

Запустить скрипт для настройки R2:
```bash
python setup_r2_public_access.py
```

Этот скрипт:
- ✅ Открывает публичный доступ **ТОЛЬКО** к папке `photos/progress/`
- ✅ Остальные файлы остаются приватными
- ✅ Не создает риска утечки личных данных

### 2. Добавить переменную окружения в Render

В Render Dashboard → Environment → Add:
```
R2_PUBLIC_BASE=https://pub-9b30caf23edc4d0b8509a7fb15c2bd5a.r2.dev
```

### 3. Проверить результат

После настройки этот URL должен работать:
```
https://pub-9b30caf23edc4d0b8509a7fb15c2bd5a.r2.dev/photos/progress/card_progress_0066.jpg
```

## Что изменится

**До:** 
- URL возвращают `401 Unauthorized`
- Изображения не отображаются в карточках

**После:**
- Публичные URL работают для мотивационных картинок
- Карточки отображаются с изображениями
- Остальные файлы остаются защищенными

## Bucket Policy (для справки)

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "PublicReadMotivationalImages",
      "Effect": "Allow", 
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::your-bucket-name/photos/progress/*"
    }
  ]
}
```

## Безопасность

- ✅ Доступ только к папке `photos/progress/`
- ✅ Файлы не индексируются поисковиками
- ✅ URL известны только приложению
- ✅ Никакой личной информации пользователей
- ✅ Только мотивационные картинки (фитнес-фото)