{% extends 'simple/base.html' %}

{% block title %}–û—Ç–∑—ã–≤ –æ –Ω–µ–¥–µ–ª–µ {{ week_number }} - AI Fitness Coach{% endblock %}

{% block content %}
<div class="container-fluid min-vh-100 py-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            
            <!-- Header with Trainer -->
            <div class="text-center mb-4">
                <div class="trainer-header">
                    <img src="/static/images/trainers/{{ archetype }}-avatar.png" 
                         alt="–¢—Ä–µ–Ω–µ—Ä {{ archetype|title }}" 
                         class="trainer-avatar mb-3"
                         style="width: 100px; height: 100px; border-radius: 50%; border: 3px solid white; object-fit: cover;">
                    
                    <h1 class="text-white mb-2">üìä –ö–∞–∫ –ø—Ä–æ—à–ª–∞ –Ω–µ–¥–µ–ª—è?</h1>
                    
                    {% if archetype == 'bro' %}
                        <p class="text-white lead">–ë—Ä–∞—Ç–∞–Ω, –¥–∞–≤–∞–π –æ–±—Å—É–¥–∏–º –∫–∞–∫ –ø—Ä–æ—à–ª–∞ –Ω–µ–¥–µ–ª—è {{ week_number }}!</p>
                    {% elif archetype == 'sergeant' %}
                        <p class="text-white lead">–ë–æ–µ—Ü, —Ä–∞–ø–æ—Ä—Ç—É–π—Ç–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –Ω–µ–¥–µ–ª–∏ {{ week_number }}!</p>
                    {% elif archetype == 'intellectual' %}
                        <p class="text-white lead">–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ–¥–µ–ª–∏ {{ week_number }}!</p>
                    {% endif %}
                </div>
            </div>

            <!-- Feedback Form -->
            <div class="card shadow-lg border-0 mb-4" style="border-radius: 20px;">
                <div class="card-header text-center py-3" style="background: linear-gradient(45deg, #007bff, #0056b3); color: white; border-radius: 20px 20px 0 0;">
                    <h4 class="mb-0">–ù–µ–¥–µ–ª—è {{ week_number }} - {{ plan.name }}</h4>
                </div>
                
                <div class="card-body p-4">
                    <form method="post" id="feedbackForm">
                        {% csrf_token %}
                        
                        <!-- Overall Assessment -->
                        <div class="section mb-4">
                            <h5 class="text-primary mb-3">üìà –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞</h5>
                            
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–µ–¥–µ–ª–∏:</label>
                                    <select name="overall_difficulty" class="form-select">
                                        <option value="too_easy" {% if feedback.overall_difficulty == 'too_easy' %}selected{% endif %}>–°–ª–∏—à–∫–æ–º –ª–µ–≥–∫–æ</option>
                                        <option value="just_right" {% if feedback.overall_difficulty == 'just_right' %}selected{% endif %}>–í —Å–∞–º—ã–π —Ä–∞–∑</option>
                                        <option value="too_hard" {% if feedback.overall_difficulty == 'too_hard' %}selected{% endif %}>–°–ª–∏—à–∫–æ–º —Ç—è–∂–µ–ª–æ</option>
                                        <option value="varied" {% if feedback.overall_difficulty == 'varied' %}selected{% endif %}>–ü–æ-—Ä–∞–∑–Ω–æ–º—É</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–£—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏:</label>
                                    <select name="energy_level" class="form-select">
                                        <option value="low" {% if feedback.energy_level == 'low' %}selected{% endif %}>–ù–∏–∑–∫–∏–π</option>
                                        <option value="medium" {% if feedback.energy_level == 'medium' %}selected{% endif %}>–°—Ä–µ–¥–Ω–∏–π</option>
                                        <option value="high" {% if feedback.energy_level == 'high' %}selected{% endif %}>–í—ã—Å–æ–∫–∏–π</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–ú–æ—Ç–∏–≤–∞—Ü–∏—è:</label>
                                    <select name="motivation_level" class="form-select">
                                        <option value="low" {% if feedback.motivation_level == 'low' %}selected{% endif %}>–ù–∏–∑–∫–∞—è</option>
                                        <option value="medium" {% if feedback.motivation_level == 'medium' %}selected{% endif %}>–°—Ä–µ–¥–Ω—è—è</option>
                                        <option value="high" {% if feedback.motivation_level == 'high' %}selected{% endif %}>–í—ã—Å–æ–∫–∞—è</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Perception -->
                        <div class="section mb-4">
                            <h5 class="text-primary mb-3">üí™ –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">–ü—Ä–æ–≥—Ä–µ—Å—Å –≤ —Å–∏–ª–µ (1-10):</label>
                                    <input type="range" name="strength_progress" 
                                           class="form-range" 
                                           min="1" max="10" 
                                           value="{{ feedback.strength_progress }}"
                                           id="strengthRange">
                                    <div class="d-flex justify-content-between">
                                        <small>1 - –ù–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</small>
                                        <small id="strengthValue">{{ feedback.strength_progress }}</small>
                                        <small>10 - –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å</small>
                                    </div>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">–ü—Ä–æ–≥—Ä–µ—Å—Å –≤ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (1-10):</label>
                                    <input type="range" name="confidence_progress" 
                                           class="form-range" 
                                           min="1" max="10" 
                                           value="{{ feedback.confidence_progress }}"
                                           id="confidenceRange">
                                    <div class="d-flex justify-content-between">
                                        <small>1 - –ù–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</small>
                                        <small id="confidenceValue">{{ feedback.confidence_progress }}</small>
                                        <small>10 - –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Exercise Feedback -->
                        <div class="section mb-4">
                            <h5 class="text-primary mb-3">üèãÔ∏è –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è</h5>
                            
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">–°–∞–º—ã–µ —Å–ª–æ–∂–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
                                    <select name="challenging_exercises" multiple class="form-select" size="4">
                                        {% for exercise in all_exercises %}
                                            <option value="{{ exercise.slug }}" 
                                                {% if exercise.slug in feedback.most_challenging_exercises %}selected{% endif %}>
                                                {{ exercise.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                    <small class="text-muted">–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ Ctrl –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞</small>
                                </div>
                                
                                <div class="col-md-6 mb-3">
                                    <label class="form-label">–õ—é–±–∏–º—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è:</label>
                                    <select name="favorite_exercises" multiple class="form-select" size="4">
                                        {% for exercise in all_exercises %}
                                            <option value="{{ exercise.slug }}" 
                                                {% if exercise.slug in feedback.favorite_exercises %}selected{% endif %}>
                                                {{ exercise.name }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                    <small class="text-muted">–£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ Ctrl –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞</small>
                                </div>
                            </div>
                        </div>

                        <!-- Preferences -->
                        <div class="section mb-4">
                            <h5 class="text-primary mb-3">‚öôÔ∏è –ü–æ–∂–µ–ª–∞–Ω–∏—è</h5>
                            
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" 
                                               name="wants_more_cardio" 
                                               {% if feedback.wants_more_cardio %}checked{% endif %}>
                                        <label class="form-check-label">–ë–æ–ª—å—à–µ –∫–∞—Ä–¥–∏–æ</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" 
                                               name="wants_more_strength" 
                                               {% if feedback.wants_more_strength %}checked{% endif %}>
                                        <label class="form-check-label">–ë–æ–ª—å—à–µ —Å–∏–ª–æ–≤—ã—Ö</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" 
                                               name="wants_shorter_workouts" 
                                               {% if feedback.wants_shorter_workouts %}checked{% endif %}>
                                        <label class="form-check-label">–ö–æ—Ä–æ—á–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" 
                                               name="wants_longer_workouts" 
                                               {% if feedback.wants_longer_workouts %}checked{% endif %}>
                                        <label class="form-check-label">–î–ª–∏–Ω–Ω–µ–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Free Text Feedback -->
                        <div class="section mb-4">
                            <h5 class="text-primary mb-3">üí¨ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ</h5>
                            
                            <div class="mb-3">
                                <label class="form-label">–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–ª–æ —Ö–æ—Ä–æ—à–æ?</label>
                                <textarea name="what_worked_well" class="form-control" rows="3" 
                                          placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Ç–µ–º, —á—Ç–æ –≤–∞–º –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å...">{{ feedback.what_worked_well }}</textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">–ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å?</label>
                                <textarea name="what_needs_improvement" class="form-control" rows="3" 
                                          placeholder="–ß—Ç–æ –±—ã –≤—ã —Ö–æ—Ç–µ–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ —É–ª—É—á—à–∏—Ç—å...">{{ feedback.what_needs_improvement }}</textarea>
                            </div>
                            
                            <div class="mb-3">
                                <label class="form-label">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:</label>
                                <textarea name="additional_notes" class="form-control" rows="3" 
                                          placeholder="–õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –º—ã—Å–ª–∏ –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è...">{{ feedback.additional_notes }}</textarea>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center">
                            <button type="submit" class="btn btn-success btn-lg px-5 py-3" style="border-radius: 50px;">
                                <i class="fas fa-paper-plane me-2"></i>
                                {% if archetype == 'bro' %}
                                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤, –±—Ä–∞—Ç–∞–Ω!
                                {% elif archetype == 'sergeant' %}
                                    –ü–µ—Ä–µ–¥–∞—Ç—å —Ä–∞–ø–æ—Ä—Ç!
                                {% elif archetype == 'intellectual' %}
                                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑
                                {% endif %}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.trainer-avatar {
    box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    transition: transform 0.3s ease;
}

.trainer-avatar:hover {
    transform: scale(1.05);
}

.section {
    padding: 1.5rem;
    border-radius: 15px;
    background: rgba(0,123,255,0.05);
    border-left: 4px solid #007bff;
}

.card {
    backdrop-filter: blur(10px);
    background-color: rgba(255, 255, 255, 0.95);
}

.btn-success {
    background: linear-gradient(45deg, #28a745, #20c997);
    border: none;
    transition: all 0.3s ease;
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
}

.form-range {
    height: 0.5rem;
}

.form-range::-webkit-slider-thumb {
    background: #007bff;
    border-radius: 50%;
    height: 1.5rem;
    width: 1.5rem;
}

.form-range::-moz-range-thumb {
    background: #007bff;
    border-radius: 50%;
    height: 1.5rem;
    width: 1.5rem;
}

@media (max-width: 768px) {
    .trainer-avatar {
        width: 80px !important;
        height: 80px !important;
    }
    
    .section {
        padding: 1rem;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Update range values in real-time
    const strengthRange = document.getElementById('strengthRange');
    const confidenceRange = document.getElementById('confidenceRange');
    const strengthValue = document.getElementById('strengthValue');
    const confidenceValue = document.getElementById('confidenceValue');
    
    strengthRange.addEventListener('input', function() {
        strengthValue.textContent = this.value;
    });
    
    confidenceRange.addEventListener('input', function() {
        confidenceValue.textContent = this.value;
    });
});
</script>
{% endblock %}