{% extends "simple/base.html" %}

{% block title %}–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ - AI Fitness Coach{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <!-- Motivation Header -->
        <div class="gradient-bg rounded p-4 mb-4 text-white text-center">
            <h3 class="mb-2">{{ workout.motivation }}</h3>
            <p class="mb-0">–°–µ–≥–æ–¥–Ω—è—à–Ω—è—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≥–æ—Ç–æ–≤–∞. –î–∞–≤–∞–π –ø–æ–∫–∞–∂–µ–º –Ω–∞ —á—Ç–æ —Å–ø–æ—Å–æ–±–µ–Ω!</p>
        </div>

        <!-- Video Playlist -->
        {% if workout.videos %}
        <div class="card shadow mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0">üé¨ –í–∏–¥–µ–æ-–≥–∏–¥—ã</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    {% for video in workout.videos %}
                    <div class="col-md-6 mb-3">
                        <div class="card border-0 bg-light">
                            <div class="card-body text-center p-3">
                                <div class="fs-3 mb-2">
                                    {% if video.type == 'technique' %}üéØ
                                    {% elif video.type == 'motivation' %}üí™
                                    {% else %}üìπ{% endif %}
                                </div>
                                <h6 class="mb-2">{{ video.title }}</h6>
                                <button class="btn btn-sm btn-outline-primary" onclick="alert('–í–∏–¥–µ–æ: {{ video.title }}')">
                                    ‚ñ∂Ô∏è –°–º–æ—Ç—Ä–µ—Ç—å
                                </button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Workout Exercises -->
        <div class="card shadow mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">üí™ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h5>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('complete_workout') }}" id="workoutForm">
                    {% for exercise in workout.exercises %}
                    <div class="card border-0 bg-light mb-3">
                        <div class="card-body">
                            <div class="row align-items-center">
                                <div class="col-md-6">
                                    <h6 class="fw-bold mb-1">{{ loop.index }}. {{ exercise.name }}</h6>
                                    <p class="text-muted mb-0">
                                        {{ exercise.sets }} –ø–æ–¥—Ö–æ–¥–æ–≤ √ó {{ exercise.reps }}
                                        {% if exercise.rest %} ‚Ä¢ –û—Ç–¥—ã—Ö: {{ exercise.rest }}{% endif %}
                                    </p>
                                </div>
                                <div class="col-md-6 text-end">
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-outline-secondary btn-sm" 
                                                onclick="alert('–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ –¥–ª—è {{ exercise.name }}')">
                                            üîÑ –ó–∞–º–µ–Ω–∏—Ç—å
                                        </button>
                                        <button type="button" class="btn btn-outline-info btn-sm"
                                                onclick="alert('–¢–µ—Ö–Ω–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: {{ exercise.name }}')">
                                            üéØ –¢–µ—Ö–Ω–∏–∫–∞
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Exercise Completion -->
                            <div class="mt-3">
                                <label class="form-label small">–ö–∞–∫ –ø—Ä–æ—à–ª–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ?</label>
                                <div class="btn-group w-100" role="group">
                                    <input type="radio" class="btn-check" name="exercise_{{ loop.index0 }}" 
                                           id="easy_{{ loop.index0 }}" value="easy">
                                    <label class="btn btn-outline-success" for="easy_{{ loop.index0 }}">üòä –õ–µ–≥–∫–æ</label>
                                    
                                    <input type="radio" class="btn-check" name="exercise_{{ loop.index0 }}" 
                                           id="normal_{{ loop.index0 }}" value="normal" checked>
                                    <label class="btn btn-outline-primary" for="normal_{{ loop.index0 }}">üëç –ù–æ—Ä–º–∞–ª—å–Ω–æ</label>
                                    
                                    <input type="radio" class="btn-check" name="exercise_{{ loop.index0 }}" 
                                           id="hard_{{ loop.index0 }}" value="hard">
                                    <label class="btn btn-outline-warning" for="hard_{{ loop.index0 }}">üòÖ –¢—è–∂–µ–ª–æ</label>
                                    
                                    <input type="radio" class="btn-check" name="exercise_{{ loop.index0 }}" 
                                           id="failed_{{ loop.index0 }}" value="failed">
                                    <label class="btn btn-outline-danger" for="failed_{{ loop.index0 }}">üòµ –ù–µ —Å–º–æ–≥</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}

                    <!-- Overall Feedback -->
                    <div class="card border-primary">
                        <div class="card-header bg-primary text-white">
                            <h6 class="mb-0">üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                                    <select class="form-select" name="difficulty" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                                        <option value="too_easy">–°–ª–∏—à–∫–æ–º –ª–µ–≥–∫–æ</option>
                                        <option value="just_right" selected>–í —Å–∞–º—ã–π —Ä–∞–∑</option>
                                        <option value="too_hard">–°–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–£–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ:</label>
                                    <select class="form-select" name="enjoyment" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                                        <option value="loved">–û–±–æ–∂–∞—é! üòç</option>
                                        <option value="liked" selected>–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å üëç</option>
                                        <option value="neutral">–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ üòê</option>
                                        <option value="disliked">–ù–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å üëé</option>
                                    </select>
                                </div>
                                <div class="col-md-4 mb-3">
                                    <label class="form-label">–≠–Ω–µ—Ä–≥–∏—è –ø–æ—Å–ª–µ:</label>
                                    <select class="form-select" name="energy" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
                                        <option value="energized">–≠–Ω–µ—Ä–≥–∏–∏ –ø—Ä–∏–±–∞–≤–∏–ª–æ—Å—å! ‚ö°</option>
                                        <option value="satisfied" selected>–ü—Ä–∏—è—Ç–Ω–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å üòå</option>
                                        <option value="tired">–£—Å—Ç–∞–ª, –Ω–æ –¥–æ–≤–æ–ª–µ–Ω üò¥</option>
                                        <option value="exhausted">–ü–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–∂–∞—Ç ü•µ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-success btn-lg">
                            üèÜ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (+50 XP)
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
// Auto-scroll to next exercise when one is completed
document.querySelectorAll('input[type="radio"]').forEach(radio => {
    radio.addEventListener('change', function() {
        if (this.name.startsWith('exercise_')) {
            // Small delay then scroll to next exercise
            setTimeout(() => {
                const currentIndex = parseInt(this.name.split('_')[1]);
                const nextExercise = document.querySelector(`input[name="exercise_${currentIndex + 1}"]`);
                if (nextExercise) {
                    nextExercise.closest('.card').scrollIntoView({ behavior: 'smooth', block: 'center' });
                } else {
                    // Last exercise, scroll to feedback
                    document.querySelector('.card.border-primary').scrollIntoView({ behavior: 'smooth' });
                }
            }, 500);
        }
    });
});

// Form validation
document.getElementById('workoutForm').addEventListener('submit', function(e) {
    const exercises = document.querySelectorAll('input[name^="exercise_"]:checked');
    if (exercises.length === 0) {
        e.preventDefault();
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ü–µ–Ω–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ!');
        return false;
    }
    
    // Show completion animation
    this.querySelector('button[type="submit"]').innerHTML = 'üéâ –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç...';
    this.querySelector('button[type="submit"]').disabled = true;
});
</script>
{% endblock %}